<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Attestation Created - attest.ink</title>
    <meta name="description" content="Your AI attestation has been created successfully">
    <link rel="icon" type="image/svg+xml" href="/assets/logo/favicon.svg">
    <link rel="apple-touch-icon" href="/assets/apple-touch-icon.png">
    <link rel="icon" type="image/x-icon" href="/assets/favicon.ico">
    <link rel="manifest" href="/assets/site.webmanifest">
    <meta name="theme-color" content="#111827">
    <link rel="stylesheet" href="/static/style.css">
    <link rel="stylesheet" href="/static/badge-styles.css">
    <script src="/static/ai-models.js?v=2"></script>
    <script>
        // Prevent theme flicker by setting theme before render
        (function() {
            const saved = localStorage.getItem('theme');
            let theme = 'light';
            if (saved) {
                theme = saved;
            } else if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                theme = 'dark';
            } else {
                const hour = new Date().getHours();
                if (hour >= 18 || hour < 6) {
                    theme = 'dark';
                }
            }
            document.documentElement.setAttribute('data-theme', theme);
        })();
    </script>
</head>
<body>
    <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">D</button>
    <div class="container">
        <nav>
            <div class="nav-inner">
                <a href="/" class="logo">
                    <img src="/assets/logo/circular-2-ai.svg" alt="attest.ink logo">
                    <span>attest.ink</span>
                </a>
                <ul>
                    <li><a href="/create/">Create</a></li>
                    <li><a href="/verify/">Verify</a></li>
                    <li class="dropdown">
                        <span class="dropdown-toggle">More</span>
                        <div class="dropdown-menu">
                            <a href="/protocol/">Protocol</a>
                            <a href="/showcase/">Badges</a>
                            <a href="/examples/">Examples</a>
                            <a href="/developers/">Developers</a>
                            <a href="/faq.html">FAQ</a>
                            <a href="https://github.com/attestation-ink" target="_blank">GitHub</a>
                        </div>
                    </li>
                </ul>
            </div>
        </nav>
        
        <main>
            <div id="result-section" style="margin-top: 40px;">
                <h2>Attestation Created</h2>
                
                <pre id="attestation-json"></pre>

                <div style="margin-top: 20px; display: flex; gap: 10px; flex-wrap: wrap;">
                    <button id="download-json" class="btn btn-secondary">Download JSON</button>
                    <button id="copy-json" class="btn btn-secondary">Copy JSON</button>
                    <a href="/verify/" id="verify-link" class="btn btn-secondary">Verify Attestation</a>
                    <a href="/create/" class="btn">Create Another</a>
                </div>

                <h3 style="margin-top: 40px;">Share Your Attestation</h3>
                
                <div id="badge-section">
                    <div id="badge-preview" style="margin: 20px 0; padding: 20px; background: var(--bg-panel); border: 1px solid var(--border-color); border-radius: 8px; text-align: center;"></div>
                    
                    <div id="embed-section">
                        <h4>Option 1: Embed Badge</h4>
                        <p style="margin-bottom: 10px;">Self-contained HTML with full attestation data (works offline):</p>
                        <pre id="badge-embed-code"></pre>
                        <button id="copy-embed-code" class="btn btn-secondary">Copy Embed Code</button>
                    </div>
                    
                    <div id="link-section" style="margin-top: 20px;">
                        <h4>Option 2: Direct Links</h4>
                        <div style="margin-bottom: 15px;">
                            <p style="margin-bottom: 5px;"><strong>Short URL</strong> (Premium feature):</p>
                            <pre id="badge-link-code" style="padding: 10px; background: var(--bg-panel); border: 1px solid var(--border-color); border-radius: 4px; overflow-x: auto; font-size: 14px; color: var(--text-primary); min-height: 20px;"></pre>
                            <button id="copy-link-code" class="btn btn-secondary">Copy Short URL</button>
                        </div>
                        <div>
                            <p style="margin-bottom: 5px;"><strong>Full Data URL</strong> (works offline, self-contained):</p>
                            <pre id="badge-data-url" style="padding: 10px; background: var(--bg-panel); border: 1px solid var(--border-color); border-radius: 4px; overflow-x: auto; font-size: 14px; color: var(--text-primary); min-height: 20px; word-wrap: break-word; white-space: pre-wrap;"></pre>
                            <button id="copy-data-url" class="btn btn-secondary">Copy Data URL</button>
                        </div>
                    </div>
                    
                    <div id="api-section" style="margin-top: 20px;">
                        <h4>Option 3: API / Automation</h4>
                        <p style="margin-bottom: 10px;">Create attestations programmatically using curl:</p>
                        <pre id="api-curl-command" style="font-size: 0.9em;"></pre>
                        <button id="copy-api-command" class="btn btn-secondary">Copy curl Command</button>
                    </div>
                    
                    <div id="latex-section" style="display: none; margin-top: 20px;">
                        <h4>LaTeX Code</h4>
                        <p><strong>Step 1:</strong> Add this line to your main .tex file where you want the AI attestation to appear:</p>
                        <pre id="latex-code" style="font-size: 0.9em;"></pre>
                        <button id="copy-latex-code" class="btn btn-secondary">Copy Main File Code</button>
                        
                        <p style="margin-top: 15px;"><strong>Step 2:</strong> Create a file named <code>ai-attestation.tex</code> with this content:</p>
                        <pre id="latex-extended" style="font-size: 0.9em;"></pre>
                        <button id="copy-latex-extended" class="btn btn-secondary">Copy ai-attestation.tex Content</button>
                        
                        <div style="margin-top: 15px; padding: 15px; background: var(--bg-panel); border: 1px solid var(--border-color); border-radius: 4px;">
                            <p style="margin: 0;"><strong>Note:</strong> This modular approach keeps your AI attestation in a separate file, making it easy to update or remove. Add <code>\clearpage</code> before the <code>\input</code> command if you want the attestation to start on a new page.</p>
                        </div>
                    </div>
                    
                    <div id="markdown-section" style="display: none; margin-top: 20px;">
                        <h4>Markdown Code</h4>
                        <pre id="markdown-code" style="font-size: 0.9em;"></pre>
                        <button id="copy-markdown-code" class="btn btn-secondary">Copy Markdown</button>
                    </div>
                </div>
            </div>
        </main>
        
        <footer>
            <p>A public-benefit, open-source AI integrity protocol | <a href="/protocol/">Learn about the protocol</a></p>
        </footer>
    </div>
    <script src="/static/modal.js"></script>
    <script src="/static/theme.js"></script>
    <script src="/static/mobile-nav.js"></script>
    <script src="/static/global-footer.js"></script>
    <script src="/attestation-result.js"></script>
    <script>
        // Get attestation from URL parameters or localStorage
        const urlParams = new URLSearchParams(window.location.search);
        const attestationId = urlParams.get('id');
        
        if (!attestationId) {
            alert('No attestation ID provided');
            window.location.href = '/create/';
        } else {
            // Try to load from localStorage
            const storedAttestation = localStorage.getItem(`attestation-${attestationId}`);
            if (!storedAttestation) {
                alert('Attestation not found. It may have been created in a different browser.');
                window.location.href = '/create/';
            } else {
                const attestation = JSON.parse(storedAttestation);
                window.currentAttestation = attestation;
                
                // Display the attestation
                document.getElementById('attestation-json').textContent = JSON.stringify(attestation, null, 2);
                
                // Update verify link
                document.getElementById('verify-link').href = `/verify/?id=${attestation.id}`;
                
                // Generate all the display elements
                generateAttestationDisplay(attestation);
                
                // Initialize copy button handlers
                initializeCopyButtons();
            }
        }
        
        // Copy event listeners
        document.getElementById('download-json').addEventListener('click', function() {
            const blob = new Blob([JSON.stringify(window.currentAttestation, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `attestation-${window.currentAttestation.id}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        });

        document.getElementById('copy-json').addEventListener('click', async function() {
            try {
                await navigator.clipboard.writeText(JSON.stringify(window.currentAttestation, null, 2));
                this.textContent = 'Copied!';
                setTimeout(() => {
                    this.textContent = 'Copy JSON';
                }, 2000);
            } catch (err) {
                alert('Failed to copy JSON');
            }
        });
    </script>
</body>
</html>